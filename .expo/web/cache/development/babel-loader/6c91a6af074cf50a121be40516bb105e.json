{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useMutation } from '@apollo/client';\nimport { SIGN_IN } from \"../graphql/mutations\";\nimport { useApolloClient } from '@apollo/client';\nimport useAuthStorage from \"../hooks/useAuthStorage\";\nvar useSignIn = function useSignIn() {\n  var client = useApolloClient();\n  var authStorage = useAuthStorage();\n  var _useMutation = useMutation(SIGN_IN, {\n      onError: function onError(error) {\n        console.log(error.graphQLErrors[0].message);\n      }\n    }),\n    _useMutation2 = _slicedToArray(_useMutation, 2),\n    mutate = _useMutation2[0],\n    result = _useMutation2[1];\n  var signIn = function () {\n    var _ref2 = _asyncToGenerator(function* (_ref) {\n      var username = _ref.username,\n        password = _ref.password;\n      var _yield$mutate = yield mutate({\n          variables: {\n            username: username,\n            password: password\n          }\n        }),\n        data = _yield$mutate.data;\n      yield authStorage.setAccessToken(data.authenticate.accessToken);\n      yield client.resetStore();\n      console.log('signin hook', yield authStorage.getAccessToken());\n      return {\n        data: data\n      };\n    });\n    return function signIn(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return [signIn, result];\n};\nexport default useSignIn;","map":{"version":3,"names":["useMutation","SIGN_IN","useApolloClient","useAuthStorage","useSignIn","client","authStorage","onError","error","console","log","graphQLErrors","message","mutate","result","signIn","username","password","variables","data","setAccessToken","authenticate","accessToken","resetStore","getAccessToken"],"sources":["D:/Ohjelmointi/Full Stack Open/Exercises/Part 10/rate-repository-app/src/hooks/useSignIn.js"],"sourcesContent":["import { useMutation } from '@apollo/client';\nimport { SIGN_IN } from '../graphql/mutations';\nimport { useApolloClient } from '@apollo/client';\n\nimport useAuthStorage from '../hooks/useAuthStorage';\n\nconst useSignIn = () => {\n  const client = useApolloClient();\n  const authStorage = useAuthStorage();\n\n  const [mutate, result] = useMutation(SIGN_IN, {\n    onError: (error) => {\n      console.log(error.graphQLErrors[0].message);\n    }\n  });\n\n  const signIn = async ({ username, password }) => {\n    const { data } = await mutate({ variables: { username: username, password: password } })\n    await authStorage.setAccessToken(data.authenticate.accessToken);\n    await client.resetStore();\n    console.log('signin hook', await authStorage.getAccessToken());\n    return { data };\n  };\n\n  return [signIn, result];\n};\n\nexport default useSignIn;"],"mappings":";;AAAA,SAASA,WAAW,QAAQ,gBAAgB;AAC5C,SAASC,OAAO;AAChB,SAASC,eAAe,QAAQ,gBAAgB;AAEhD,OAAOC,cAAc;AAErB,IAAMC,SAAS,GAAG,SAAZA,SAAS,GAAS;EACtB,IAAMC,MAAM,GAAGH,eAAe,EAAE;EAChC,IAAMI,WAAW,GAAGH,cAAc,EAAE;EAEpC,mBAAyBH,WAAW,CAACC,OAAO,EAAE;MAC5CM,OAAO,EAAE,iBAACC,KAAK,EAAK;QAClBC,OAAO,CAACC,GAAG,CAACF,KAAK,CAACG,aAAa,CAAC,CAAC,CAAC,CAACC,OAAO,CAAC;MAC7C;IACF,CAAC,CAAC;IAAA;IAJKC,MAAM;IAAEC,MAAM;EAMrB,IAAMC,MAAM;IAAA,8BAAG,iBAAkC;MAAA,IAAzBC,QAAQ,QAARA,QAAQ;QAAEC,QAAQ,QAARA,QAAQ;MACxC,0BAAuBJ,MAAM,CAAC;UAAEK,SAAS,EAAE;YAAEF,QAAQ,EAAEA,QAAQ;YAAEC,QAAQ,EAAEA;UAAS;QAAE,CAAC,CAAC;QAAhFE,IAAI,iBAAJA,IAAI;MACZ,MAAMb,WAAW,CAACc,cAAc,CAACD,IAAI,CAACE,YAAY,CAACC,WAAW,CAAC;MAC/D,MAAMjB,MAAM,CAACkB,UAAU,EAAE;MACzBd,OAAO,CAACC,GAAG,CAAC,aAAa,QAAQJ,WAAW,CAACkB,cAAc,EAAE,CAAC;MAC9D,OAAO;QAAEL,IAAI,EAAJA;MAAK,CAAC;IACjB,CAAC;IAAA,gBANKJ,MAAM;MAAA;IAAA;EAAA,GAMX;EAED,OAAO,CAACA,MAAM,EAAED,MAAM,CAAC;AACzB,CAAC;AAED,eAAeV,SAAS"},"metadata":{},"sourceType":"module"}